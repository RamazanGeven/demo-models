#X3D V3.2 utf8
PROFILE Interchange

# Test what happens when a relative URL is an MFString parameter
EXTERNPROTO BlueGeometry [
  inputOutput MFString sphereTexture
] [ "blue/prototype.x3dv#BlueGeometry" ]

EXTERNPROTO RedGeometry [
  inputOutput MFString sphereTexture
] [ "red/prototype.x3dv#RedGeometry" ]

# Test what happens when a relative URL is inside SFNode with ImageTexture parameter
EXTERNPROTO YellowGeometry [
  inputOutput SFNode sphereTextureNode
] [ "yellow/prototype.x3dv#YellowGeometry" ]

# Test what happens when a relative URL is an MFString parameter,
# and the same prototype is also used inside Inline model.
EXTERNPROTO GreenGeometry [
  inputOutput MFString sphereTexture
] [ "green/prototype.x3dv#GreenGeometry" ]

# Test what happens when a relative URL is inside an Inline that is inside a prototype.
EXTERNPROTO GrayGeometry [
] [ "gray/prototype.x3dv#GrayGeometry" ]

BlueGeometry { sphereTexture "texture.png" }

Transform {
  translation 0 2 0
  children RedGeometry { sphereTexture "texture.png" }
}

Transform {
  translation 0 -2 0
  children YellowGeometry { sphereTextureNode ImageTexture { url "texture.png" } }
}
Transform {
  translation 0 -4 0
  children YellowGeometry { sphereTextureNode ImageTexture { url "texture.png" } }
}

Transform {
  translation 0 -6 0
  children GreenGeometry { sphereTexture "texture.png" }
}
Transform {
  translation 0 -8 0
  children Inline { url "green/include_green_geometry.x3dv" }
}

# TODO: This does work correctly in view3dscene.
# view3dscene expects URLs relative to relative_urls_test/gray/ ,
# but actually it should be URL relative to just relative_urls_test/
# (because GrayGeometry is instantiated in relative_urls_test/base.x3dv).
Transform {
  translation 0 -10 0
  children GrayGeometry { }
}

# Generated by view3dscene.
# Use view3dscene "Console -> Print Current Camera..." to generate VRML/X3D code like below.
# Camera settings "encoded" in the VRML/X3D declaration below :
#   direction 0 0 -1
#   up 0 1 0
#   gravityUp 0 1 0
Viewpoint {
  position 4.15277719497681 -3.75000166893005 20.8666648864746
  orientation 0 0 1 0
}
